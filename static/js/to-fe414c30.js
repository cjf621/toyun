import{d as m,r as V,x as D,y as M,i as B,a as n,q as E,o as u,c as _,w as l,g as o,k as N,f as I,h as K,E as a,z as j}from"./to-6daecd4d.js";import{u as q}from"./to-e317cdfd.js";const z=m({name:"sys-log"}),F=m({...z,setup(A){const{service:t}=q(),s=V(1),c=D({service:t.base.sys.log},e=>{e.refresh()}),d=M({contextMenu:["refresh"],columns:[{type:"index",label:"#",width:60},{prop:"userId",label:"用户ID"},{prop:"name",label:"昵称",minWidth:150},{prop:"action",label:"请求地址",minWidth:200,showOverflowTooltip:!0},{prop:"params",label:"参数",minWidth:200,component:{name:"cl-code-json",props:{popover:!0}}},{prop:"ip",label:"ip",minWidth:150},{prop:"ipAddr",label:"ip地址",minWidth:150},{prop:"createTime",label:"创建时间",minWidth:160,sortable:"desc"}]});function f(){t.base.sys.log.setKeep({value:s.value}).then(()=>{a.success("保存成功")}).catch(e=>{a.error(e.message)})}function b(){j.confirm("是否要清空日志？","提示",{type:"warning"}).then(()=>{t.base.sys.log.clear().then(()=>{var e;a.success("清空成功"),(e=c.value)==null||e.refresh()}).catch(e=>{a.error(e.message)})}).catch(()=>null)}return B(()=>{t.base.sys.log.getKeep().then(e=>{s.value=Number(e)})}),(e,i)=>{const h=n("cl-refresh-btn"),g=n("el-button"),v=n("el-input-number"),y=n("cl-filter"),p=n("cl-flex1"),x=n("cl-search-key"),r=n("cl-row"),w=n("cl-table"),C=n("cl-pagination"),k=n("cl-crud"),T=E("permission");return u(),_(k,{ref_key:"Crud",ref:c},{default:l(()=>[o(r,null,{default:l(()=>[o(h),N((u(),_(g,{type:"danger",onClick:b},{default:l(()=>[K(" 清空 ")]),_:1})),[[T,I(t).base.sys.log.permission.clear]]),o(y,{label:"日志保存天数"},{default:l(()=>[o(v,{modelValue:s.value,"onUpdate:modelValue":i[0]||(i[0]=W=>s.value=W),"controls-position":"right",max:1e4,min:1,onChange:f},null,8,["modelValue"])]),_:1}),o(p),o(x,{placeholder:"搜索请求地址、参数、ip"})]),_:1}),o(r,null,{default:l(()=>[o(w,{ref_key:"Table",ref:d},null,512)]),_:1}),o(r,null,{default:l(()=>[o(p),o(C)]),_:1})]),_:1},512)}}});export{F as default};
