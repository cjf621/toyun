import{d as q,$ as I,A as J,r as S,j as M,E as r,a as c,q as W,o as d,c as A,w as s,h as u,t as y,k as L,b as f,e as k,g as a,F as P,N as T,I as H,z as N}from"./to-6daecd4d.js";import{u as K}from"./to-0a44f508.js";import{u as Q}from"./to-e317cdfd.js";import{S as R}from"./to-f25a0731.js";import{_ as U}from"./to-c27b6911.js";const X={class:"source"},Y={class:"head"},Z={class:"list"},ee={key:0,class:"empty"},te={class:"footer"},oe=q({name:"cloud-db"}),ne=q({...oe,setup(ae){const{service:w}=Q(),{ViewGroup:v}=K({label:"表",title:"数据列表",service:w.web.web,onEdit(){return{props:{labelWidth:"60px"},items:[{label:"名称",prop:"name",required:!0,component:{name:"el-input"}},{label:"内容",prop:"content",component:{name:"cl-editor-monaco",props:{language:"typescript",options:{fontSize:"16px"}}},value:I.db,required:!0},{label:"说明",prop:"readme",component:{name:"el-input",props:{type:"textarea",rows:3}}},{label:"状态",prop:"status",value:1,component:{name:"el-radio-group",options:R},required:!0}]}},onSelect(){i({page:1})}}),C=J(),b=S(!1),h=S([]),m=M({page:1,size:20,total:0}),x={page:1,size:20};function _(t,e){var o,p;return w.web.web.data({id:(p=(o=v.value)==null?void 0:o.selected)==null?void 0:p.id,method:t,params:e})}async function i(t){Object.assign(x,t),b.value=!0,await _("page",x).then(e=>{h.value=e.list,Object.assign(m,e.pagination)}).catch(e=>{r.error(e.message)}),b.value=!1}function V(){var t,e;N.confirm(`此操作将会清空表（${(e=(t=v.value)==null?void 0:t.selected)==null?void 0:e.name}）的所有数据，是否继续？`,"提示",{type:"warning"}).then(()=>{_("clear").then(()=>{r.success("清空数据成功"),i()}).catch(o=>{r.error(o.message)})}).catch(()=>null)}function $(t){N.confirm("此操作将会删除选择的数据，是否继续？","提示",{type:"warning"}).then(()=>{_("delete",{ids:[t]}).then(()=>{r.success("删除数据成功"),i()}).catch(e=>{r.error(e.message)})}).catch(()=>null)}function z(t){var e;(e=C.value)==null||e.open({title:t?"编辑数据":"添加数据",props:{labelWidth:"60px"},items:[{label:"内容",prop:"content",component:{name:"cl-editor-monaco",props:{options:{fontSize:"16px"}}},value:"{}",required:!0}],form:{content:JSON.stringify(t,null,4)},on:{submit(o,{close:p,done:g}){try{_(t?"update":"add",JSON.parse(o.content)).then(()=>{r.success("保存成功"),p(),i()}).catch(l=>{r.error(l.message),g()})}catch(l){r.error(l==null?void 0:l.toString()),g()}}}})}function j(t){i({page:t})}return(t,e)=>{const o=c("el-button"),p=c("cl-code-json"),g=c("el-empty"),l=c("el-scrollbar"),B=c("el-pagination"),E=c("cl-form"),F=c("cl-view-group"),O=W("loading");return d(),A(F,{ref_key:"ViewGroup",ref:v},{"item-name":s(({item:n})=>[u(y(n.name)+" - "+y(n.tableName)+" - "+y(n.className),1)]),right:s(()=>[L((d(),f("div",X,[k("div",Y,[a(o,{onClick:e[0]||(e[0]=n=>i())},{default:s(()=>[u("刷新")]),_:1}),a(o,{type:"success",onClick:e[1]||(e[1]=n=>z())},{default:s(()=>[u("添加")]),_:1}),a(o,{type:"danger",onClick:e[2]||(e[2]=n=>V())},{default:s(()=>[u("清空")]),_:1})]),a(l,{class:"scrollbar"},{default:s(()=>[k("div",Z,[(d(!0),f(P,null,T(h.value,(n,D)=>(d(),f("div",{class:"item",key:D},[a(p,{"model-value":n,height:150},{op:s(()=>[a(o,{type:"primary",size:"small",onClick:G=>z(n)},{default:s(()=>[u("编辑")]),_:2},1032,["onClick"]),a(o,{type:"danger",size:"small",onClick:G=>$(n.id)},{default:s(()=>[u("删除")]),_:2},1032,["onClick"])]),_:2},1032,["model-value"])]))),128))]),h.value.length==0?(d(),f("div",ee,[a(g,{"image-size":100})])):H("",!0)]),_:1}),k("div",te,[a(B,{background:"",layout:"prev, pager, next","current-page":m.page,total:m.total,"page-size":m.size,onCurrentChange:j},null,8,["current-page","total","page-size"])]),a(E,{ref_key:"Form",ref:C},null,512)])),[[O,b.value]])]),_:1},512)}}});const pe=U(ne,[["__scopeId","data-v-f331df96"]]);export{pe as default};
