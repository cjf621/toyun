import{d as h,r as C,i as U,o as m,b as v,E as i,u as $,j as E,a as w,e as o,t as K,f as I,g as d,w as _,k as x,v as k,l as N,h as D,p as H,m as j}from"./to-dbebbab1.js";import{u as T}from"./to-4abe4e3d.js";import{_ as S}from"./to-c27b6911.js";import{u as O}from"./to-8a5885f5.js";const P=["innerHTML"],R=["src"],W=h({name:"undefined"}),q=h({...W,emits:["update:modelValue","change"],setup(u,{expose:g,emit:f}){const{service:b}=T(),p=C(""),n=C("");function l(){b.base.open.captcha({height:40,width:150}).then(({captchaId:r,data:t})=>{t.includes(";base64,")?p.value=t:n.value=t,f("update:modelValue",r),f("change",{base64:p,svg:n,captchaId:r})}).catch(r=>{i.error(r.message)})}return U(()=>{l()}),g({refresh:l}),(r,t)=>(m(),v("div",{class:"captcha",onClick:l},[n.value?(m(),v("div",{key:0,class:"svg",innerHTML:n.value},null,8,P)):(m(),v("img",{key:1,class:"base64",src:p.value,alt:""},null,8,R))]))}});const z=S(q,[["__scopeId","data-v-e10ae32d"]]),M=u=>(H("data-v-ec1df71b"),u=u(),j(),u),A={class:"page-login"},F={class:"box"},G={class:"logo"},J=M(()=>o("img",{src:"https://store.heytapimage.com/cdo-portal/feedback/202305/30/70db37fcfb930c67655ce8efb3625ee0.png",alt:"Logo"},null,-1)),Q=M(()=>o("p",{class:"desc"},"TOseer--最高端的赛尔贴身助手",-1)),X={class:"row"},Y=["onKeyup"],Z={class:"op"},ee=h({name:"login"}),se=h({...ee,setup(u){const{refs:g,setRefs:f,router:b,service:p}=T(),{user:n,app:l}=$();O().close();const t=C(!1),e=E({username:"",password:"",captchaId:"",verifyCode:""});async function V(){if(!e.username)return i.error("用户名不能为空");if(!e.password)return i.error("密码不能为空");if(!e.verifyCode)return i.error("图片验证码不能为空");t.value=!0;try{await p.base.open.login(e).then(c=>{i.success("登录成功"),n.setToken(c)}),await Promise.all(l.events.hasToken.map(c=>c())),b.push("/")}catch(c){g.captcha.refresh(),i.error(c.message)}t.value=!1}return(c,s)=>{const y=w("el-form-item"),B=w("el-button"),L=w("el-form");return m(),v("div",A,[o("div",F,[o("div",G,[J,o("span",null,K(I(l).info.name),1)]),Q,d(L,{"label-position":"top",class:"form",disabled:t.value},{default:_(()=>[d(y,{label:"米米号"},{default:_(()=>[x(o("input",{"onUpdate:modelValue":s[0]||(s[0]=a=>e.username=a),placeholder:"请输入米米号",maxlength:"20",autocomplete:"on"},null,512),[[k,e.username]])]),_:1}),d(y,{label:"密码"},{default:_(()=>[x(o("input",{"onUpdate:modelValue":s[1]||(s[1]=a=>e.password=a),type:"password",placeholder:"请输入密码",maxlength:"20",autocomplete:"off"},null,512),[[k,e.password]])]),_:1}),d(y,{label:"验证码"},{default:_(()=>[o("div",X,[x(o("input",{"onUpdate:modelValue":s[2]||(s[2]=a=>e.verifyCode=a),placeholder:"图片验证码",maxlength:"4",onKeyup:N(V,["enter"])},null,40,Y),[[k,e.verifyCode]]),d(z,{ref:I(f)("captcha"),modelValue:e.captchaId,"onUpdate:modelValue":s[3]||(s[3]=a=>e.captchaId=a),onChange:s[4]||(s[4]=()=>{e.verifyCode=""})},null,8,["modelValue"])])]),_:1}),o("div",Z,[d(B,{round:"",loading:t.value,onClick:V},{default:_(()=>[D("登录")]),_:1},8,["loading"])])]),_:1},8,["disabled"])])])}}});const le=S(se,[["__scopeId","data-v-ec1df71b"]]);export{le as default};
