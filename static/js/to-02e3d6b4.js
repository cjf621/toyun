import{d as k,r as d,A as I,y as O,a3 as U,x as J,M,a as n,o as y,c as $,w as a,h as m,t as g,g as t,f as H,b as K,N as P,F as Q}from"./to-6daecd4d.js";import{u as W}from"./to-e317cdfd.js";import{u as X}from"./to-0a44f508.js";import{i as Y}from"./to-d5b99870.js";const Z=k({name:"job-list"}),re=k({...Z,setup(ee){const x=["flash","h5"],b=d(["flash"]),{service:p,refs:te,setRefs:C}=W(),T=I();d();const f=d(),N=[{date:"2016-05-03",name:"Tom",address:"No. 189, Grove St, Los Angeles"},{date:"2016-05-02",name:"Tom",address:"No. 189, Grove St, Los Angeles"},{date:"2016-05-04",name:"Tom",address:"No. 189, Grove St, Los Angeles"},{date:"2016-05-01",name:"Tom",address:"No. 189, Grove St, Los Angeles"}],h=O({columns:[{type:"expand",prop:"detail"},{prop:"name",label:"任务名称"},{prop:"remark",label:"备注",showOverflowTooltip:!0},{type:"op",width:260,buttons:["edit",{label:"配置",type:"warning",onClick({scope:e}){var o;(o=T.value)==null||o.open({title:"云任务配置",items:[{label:"次数",prop:"name1",value:e.row.limit,required:!0,component:{name:"el-input",props:{placeholder:"请输入次数",type:"number"}}},{label:"类型",prop:"name3",value:f,required:!1,component:{name:"el-switch",props:{placeholder:"请输入参数","active-text":"h5","inactive-text":"flash"}}},{label:"参数",prop:"name2",value:f,required:!1,component:{name:"el-input",props:{placeholder:"请输入参数",autosize:"{ minRows: 2, maxRows: 4 }",type:"textarea"}}}],on:{submit(l,{close:s,done:w}){e.row.limit=l.name1,e.row.conf=l.name2,e.row.jobtype=l.name3,s()}}})}},{label:"执行",type:"success",onClick({scope:e}){JSON.parse(localStorage.getItem("account")).forEach(l=>{p.job.list.start({name:e.row.name,id:l,count:e.row.limit,type:e.row.jobtype,conf:e.row.conf}).then(s=>{Y.addbop(l,e.row.name,s)})})}}]}]});U();const{ViewGroup:G}=X({label:"类型",title:"云任务列表",service:p.job.type,onSelect(e){S({type:e.id,page:1})},onEdit(){return{}}}),i=J({service:p.job.list,onRefresh(e,{render:o}){p.job.list.list({...e,page:void 0,size:void 0}).then(l=>{o(M(l,e.sort))})}});function S(e){var o;(o=i.value)==null||o.refresh(e)}function V(e,o){var l;o!=null&&o.property&&e.children&&((l=h.value)==null||l.toggleRowExpansion(e))}function j(e){var o;(o=i.value)==null||o.rowAppend({parentId:e.id,orderNum:1})}return(e,o)=>{const l=n("cl-refresh-btn"),s=n("cl-add-btn"),w=n("cl-multi-delete-btn"),v=n("cl-flex1"),A=n("cl-search-key"),u=n("cl-row"),_=n("el-table-column"),R=n("el-table"),L=n("el-button"),z=n("cl-table"),D=n("el-checkbox-button"),E=n("el-checkbox-group"),F=n("cl-upsert"),q=n("cl-crud"),B=n("cl-view-group");return y(),$(B,{ref_key:"ViewGroup",ref:G},{"item-name":a(({item:c})=>[m(g(c.name),1)]),right:a(()=>[t(q,{ref_key:"Crud",ref:i},{default:a(()=>[t(u,null,{default:a(()=>[t(l),t(s),t(w),t(v),t(A,{placeholder:"搜索名称"})]),_:1}),t(u,null,{default:a(()=>[t(z,{ref_key:"Table",ref:h,"row-key":"id",onRowClick:V},{"column-detail":a(({scope:c})=>[t(R,{data:N,stripe:"",style:{width:"100%"}},{default:a(()=>[t(_,{prop:"username",label:"ID",width:"180"}),t(_,{prop:"status",label:"状态",width:"180"}),t(_,{prop:"starttime",label:"开始时间"})]),_:1})]),"slot-btn":a(({scope:c})=>[t(L,{text:"",bg:"",type:"success",onClick:r=>j(c.row)},{default:a(()=>[m("新增")]),_:2},1032,["onClick"])]),_:1},512)]),_:1}),t(u,null,{default:a(()=>[t(v)]),_:1}),t(F,{ref:"Upsert"},{"slot-name":a(({scope:c})=>[t(E,{ref:H(C)("type"),modelValue:b.value,"onUpdate:modelValue":o[0]||(o[0]=r=>b.value=r),size:"large"},{default:a(()=>[(y(),K(Q,null,P(x,r=>t(D,{key:r,label:r},{default:a(()=>[m(g(r),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1},512)]),_:1},512)]),_:1},512)}}});export{re as default};
