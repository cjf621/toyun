import{d as x,L as I,B,s as E,y as G,x as R,M as S,a as n,q as U,o as v,c as w,w as a,h as y,t as k,g as r,k as M,f as z}from"./to-0ff82d88.js";import{u as A}from"./to-1c1a365c.js";import{u as F}from"./to-c0dfd301.js";const K=x({name:"dict-list"}),J=x({...K,setup(L){const{service:i}=A(),{ViewGroup:f}=F({label:"类型",title:"字典列表",service:i.dict.type,onSelect(t){g({typeId:t.id,page:1})},onEdit(){return{width:"500px",props:{labelWidth:"60px"},items:[{label:"名称",prop:"name",component:{name:"el-input",props:{maxlength:20}},required:!0},{label:"Key",prop:"key",component:{name:"el-input",props:{maxlength:20}},required:!0}]}}}),b=I({dialog:{width:"600px"},props:{labelWidth:"100px"},items:[{label:"上级节点",prop:"parentId",component:{name:"el-tree-select",props:{data:B(()=>{var o;const t=E((o=d.value)==null?void 0:o.data);function e(l,c){var s;l.id&&l.id==((s=b.value)==null?void 0:s.getForm("id"))&&(c=!0),c&&(l.disabled=!0),l.children&&l.children.forEach(m=>{e(m,c)})}return e({children:t},!1),t}),props:{label:"name",value:"id",children:"children",disabled:"disabled"},clearable:!0,filterable:!0,"default-expand-all":!0,"check-strictly":!0}}},{label:"名称",prop:"name",required:!0,component:{name:"el-input"}},{label:"排序",prop:"orderNum",value:1,component:{name:"el-input-number",props:{min:1}}},{label:"备注",prop:"remark",component:{name:"el-input",props:{type:"textarea",rows:4}}}],onSubmit(t,{next:e}){var o,l;e({...t,typeId:(l=(o=f.value)==null?void 0:o.selected)==null?void 0:l.id})}}),d=G({contextMenu:["refresh",t=>{var e;return{label:"新增",hidden:!((e=i.dict.info._permission)!=null&&e.add),callback(o){h(t),o()}}},"edit","delete","order-asc","order-desc"],columns:[{type:"selection"},{label:"名称",prop:"name",align:"left",minWidth:200},{label:"排序",prop:"orderNum",sortable:"desc",width:100},{label:"备注",prop:"remark",showOverflowTooltip:!0,minWidth:150},{label:"创建时间",prop:"createTime",sortable:"custom",minWidth:160},{label:"更新时间",prop:"updateTime",sortable:"custom",minWidth:160},{type:"op",width:250,buttons:["slot-btn","edit","delete"]}]}),u=R({service:i.dict.info,onRefresh(t,{render:e}){i.dict.info.list({...t,page:void 0,size:void 0}).then(o=>{e(S(o,t.sort))})}});function g(t){var e;(e=u.value)==null||e.refresh(t)}function C(t,e){var o;e!=null&&e.property&&t.children&&((o=d.value)==null||o.toggleRowExpansion(t))}function h(t){var e;(e=u.value)==null||e.rowAppend({parentId:t.id,orderNum:1})}return(t,e)=>{const o=n("cl-refresh-btn"),l=n("cl-add-btn"),c=n("cl-multi-delete-btn"),s=n("cl-flex1"),m=n("cl-search-key"),_=n("cl-row"),T=n("el-button"),W=n("cl-table"),N=n("cl-upsert"),V=n("cl-crud"),q=n("cl-view-group"),D=U("permission");return v(),w(q,{ref_key:"ViewGroup",ref:f},{"item-name":a(({item:p})=>[y(k(p.name)+" - "+k(p.key),1)]),right:a(()=>[r(V,{ref_key:"Crud",ref:u},{default:a(()=>[r(_,null,{default:a(()=>[r(o),r(l),r(c),r(s),r(m,{placeholder:"搜索名称"})]),_:1}),r(_,null,{default:a(()=>[r(W,{ref_key:"Table",ref:d,"row-key":"id",onRowClick:C},{"slot-btn":a(({scope:p})=>[M((v(),w(T,{text:"",bg:"",type:"success",onClick:O=>h(p.row)},{default:a(()=>[y("新增")]),_:2},1032,["onClick"])),[[D,z(i).dict.info.permission.add]])]),_:1},512)]),_:1}),r(_,null,{default:a(()=>[r(s)]),_:1}),r(N,{ref_key:"Upsert",ref:b},null,512)]),_:1},512)]),_:1},512)}}});export{J as default};
