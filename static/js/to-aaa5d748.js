import{d as h,r as V,i as U,o as f,b as v,E as i,u as $,j as E,a as w,e as o,t as S,f as x,g as d,w as _,k,v as C,l as K,h as N,p as D,m as H}from"./to-6daecd4d.js";import{u as T}from"./to-e317cdfd.js";import{_ as M}from"./to-c27b6911.js";import{u as j}from"./to-0405b573.js";import"./to-d5b99870.js";const P=["innerHTML"],R=["src"],W=h({name:"undefined"}),q=h({...W,emits:["update:modelValue","change"],setup(u,{expose:g,emit:m}){const{service:b}=T(),p=V(""),l=V("");function a(){b.base.open.captcha({height:40,width:150}).then(({captchaId:r,data:t})=>{t.includes(";base64,")?p.value=t:l.value=t,m("update:modelValue",r),m("change",{base64:p,svg:l,captchaId:r})}).catch(r=>{i.error(r.message)})}return U(()=>{a()}),g({refresh:a}),(r,t)=>(f(),v("div",{class:"captcha",onClick:a},[l.value?(f(),v("div",{key:0,class:"svg",innerHTML:l.value},null,8,P)):(f(),v("img",{key:1,class:"base64",src:p.value,alt:""},null,8,R))]))}});const z=M(q,[["__scopeId","data-v-9bd0e7a0"]]),A=u=>(D("data-v-8d7c4d08"),u=u(),H(),u),F={class:"page-login"},G={class:"box"},J={class:"logo"},O=A(()=>o("img",{src:"https://store.heytapimage.com/cdo-portal/feedback/202305/30/70db37fcfb930c67655ce8efb3625ee0.png",alt:"Logo"},null,-1)),Q={class:"desc"},X={class:"row"},Y=["onKeyup"],Z={class:"op"},ee=h({name:"login"}),se=h({...ee,setup(u){const{refs:g,setRefs:m,router:b,service:p}=T(),{user:l,app:a}=$();j().close();const t=V(!1),e=E({username:"",password:"",captchaId:"",verifyCode:""});async function I(){if(!e.username)return i.error("用户名不能为空");if(!e.password)return i.error("密码不能为空");if(!e.verifyCode)return i.error("图片验证码不能为空");t.value=!0;try{await p.base.open.login(e).then(c=>{i.success("登录成功"),l.setToken(c)}),await Promise.all(a.events.hasToken.map(c=>c())),b.push("/")}catch(c){g.captcha.refresh(),i.error(c.message)}t.value=!1}return(c,s)=>{const y=w("el-form-item"),B=w("el-button"),L=w("el-form");return f(),v("div",F,[o("div",G,[o("div",J,[O,o("span",null,S(x(a).info.name),1)]),o("p",Q,S(x(a).info.name)+"--最高端的赛尔贴身助手",1),d(L,{"label-position":"top",class:"form",disabled:t.value},{default:_(()=>[d(y,{label:"米米号"},{default:_(()=>[k(o("input",{"onUpdate:modelValue":s[0]||(s[0]=n=>e.username=n),placeholder:"请输入米米号",maxlength:"20",autocomplete:"on"},null,512),[[C,e.username]])]),_:1}),d(y,{label:"密码"},{default:_(()=>[k(o("input",{"onUpdate:modelValue":s[1]||(s[1]=n=>e.password=n),type:"password",placeholder:"请输入密码",maxlength:"20",autocomplete:"off"},null,512),[[C,e.password]])]),_:1}),d(y,{label:"验证码"},{default:_(()=>[o("div",X,[k(o("input",{"onUpdate:modelValue":s[2]||(s[2]=n=>e.verifyCode=n),placeholder:"图片验证码",maxlength:"4",onKeyup:K(I,["enter"])},null,40,Y),[[C,e.verifyCode]]),d(z,{ref:x(m)("captcha"),modelValue:e.captchaId,"onUpdate:modelValue":s[3]||(s[3]=n=>e.captchaId=n),onChange:s[4]||(s[4]=()=>{e.verifyCode=""})},null,8,["modelValue"])])]),_:1}),o("div",Z,[d(B,{round:"",loading:t.value,onClick:I},{default:_(()=>[N("登录")]),_:1},8,["loading"])])]),_:1},8,["disabled"])])])}}});const re=M(se,[["__scopeId","data-v-8d7c4d08"]]);export{re as default};
