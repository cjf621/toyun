import{d as N,r as c,aI as S,g as t,aJ as T,aK as C,aj as x,aL as p,aM as M,aN as v,h as b,F as Y,a as f,o as B,c as I,w as g,f as R,aO as K,z as j,E as w,p as z,m as F,e as V}from"./to-6daecd4d.js";import{u as H}from"./to-e317cdfd.js";import{i as r}from"./to-d5b99870.js";import{_ as L}from"./to-c27b6911.js";const J=l=>(z("data-v-7756500b"),l=l(),F(),l),W=J(()=>V("div",{class:"grid-content ep-bg-purple"},null,-1));function q(l){return typeof l=="function"||Object.prototype.toString.call(l)==="[object Object]"&&!K(l)}const A=N({name:"to-log"}),G=N({...A,setup(l){var h;const{mitt:k}=H();c(!1),c(!0);const s=c([]);function D(){j.confirm("清空所有日志?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning"}).then(()=>{w({type:"success",message:"清除完成"}),r.cleanlog(),s.value=[]}).catch(()=>{w({type:"info",message:"取消清除"})})}c(0);const O=[{key:"time",title:"Date",dataKey:"time",width:60,fixed:S.LEFT,cellRenderer:({cellData:e})=>t(p,{content:x(e).format("YYYY/MM/DD HH:mm:ss")},{default:()=>[t("span",{class:"flex items-center"},[t(T,{class:"mr-3"},{default:()=>[t(C,null,null)]}),x(e).format("YYYY/MM/DD")])]})},{key:"mimi",title:"米米号",dataKey:"mimi",width:80,align:"center",cellRenderer:({cellData:e})=>t(p,{content:e},{default:()=>[t("p",null,[e])]})},{key:"name",title:"Name",dataKey:"data",width:200,maxWidth:800,cellRenderer:({cellData:e})=>t(p,{content:e},{default:()=>[t(M,null,q(e)?e:{default:()=>[e]})]})},{key:"operations",title:"Operations",cellRenderer:()=>t(Y,null,[t(v,{size:"small",type:"danger",onClick:e=>E(e)},{default:()=>[b("删除")]})]),width:80,align:"center"},{key:"_index",title:"",dataKey:"id",width:0,align:"center",cellRenderer:({cellData:e})=>t("span",{style:{display:"none"},class:"_index"},[e])}];k.on("logfresh",()=>{d()});function d(){r.getlog().then(e=>{s.value=e}),r.getlog().then(e=>{e.forEach((_,a)=>{let o=JSON.parse(_.data);s.value[a].mimi=o.code,s.value[a].data=o.data})})}d();const m=c();(h=m.value)==null||h.scrollToTop(r.countlog());const E=e=>{var u;let a=e.target.parentNode;for(;;){const n=((u=a.className)==null?void 0:u.split(" "))||[];if(n.indexOf("el-table-v2__row")>-1)break;if(n.indexOf("el-table-v2__header")>-1||n.indexOf("el-virtual-scrollbar")>-1||n.indexOf("el-table-v2__empty")>-1)return;const y=a.parentNode;if(!y)return;a=y}const o=a.querySelector("._index");if(!o)return;const i=parseInt(o.innerHTML);isNaN(i)||(r.dellog(i),d())};return(e,_)=>{const a=f("el-table-v2"),o=f("el-auto-resizer"),i=f("el-col");return B(),I(i,{class:"grid-cell"},{default:g(()=>[W,t(R(v),{type:"danger",onClick:D},{default:g(()=>[b("清空日志")]),_:1}),t(o,null,{default:g(({height:u,width:n})=>[t(a,{columns:O,ref_key:"tableRef",ref:m,data:s.value,width:n,height:n,fixed:""},null,8,["data","width","height"])]),_:1})]),_:1})}}});const Z=L(G,[["__scopeId","data-v-7756500b"]]);export{Z as default};
